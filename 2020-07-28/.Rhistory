color = "darkgray") +
## Labeling male portion
annotate("text",
x = 20 , y = 44,
label = "males",
color = "darkgray",
size = 5) +
## Labeling female portion
annotate("text",
x = 16 , y = 34,
label = "females",
color = "darkgray",
size = 5)
## Gentoo
penguins %>%
filter(species == "Gentoo") %>%
ggplot() +
geom_point(aes(bill_depth_mm, bill_length_mm, color = sex, alpha = 0.1)) +
# Labels
xlab("Bill Depth (mm)") + ylab("Bill Length (mm)") +
labs(title = "Bill Sizes vs Gender") +
labs(subtitle = "Gentoo (Pygoscelis papua)") +
# Annotation
## Drawing a line through gender separation
annotate("segment",
x = 14, xend = 15.4, y = 53.4, yend = 43,
color = "gray",
linetype = 2)  +
## Labeling Line
annotate("text",
x = 14.4, y = 55,
label = "gender separation",
color = "darkgray") +
## Labeling male portion
annotate("text",
x = 20 , y = 44,
label = "males",
color = "darkgray",
size = 5) +
## Labeling female portion
annotate("text",
x = 16 , y = 34,
label = "females",
color = "darkgray",
size = 5)
## Gentoo
penguins %>%
filter(species == "Gentoo") %>%
ggplot() +
geom_point(aes(bill_depth_mm, bill_length_mm, color = sex, alpha = 0.1)) +
# Labels
xlab("Bill Depth (mm)") + ylab("Bill Length (mm)") +
labs(title = "Bill Sizes vs Gender") +
labs(subtitle = "Gentoo (Pygoscelis papua)") +
# Annotation
## Drawing a line through gender separation
annotate("segment",
x = 14, xend = 15.4, y = 53.4, yend = 43,
color = "gray",
linetype = 2)  +
## Labeling Line
annotate("text",
x = 14.4, y = 55,
label = "gender separation",
color = "darkgray") +
## Labeling male portion
annotate("text",
x = 16.5 , y = 55,
label = "males",
color = "darkgray",
size = 5) +
## Labeling female portion
annotate("text",
x = 16 , y = 34,
label = "females",
color = "darkgray",
size = 5)
## Gentoo
penguins %>%
filter(species == "Gentoo") %>%
ggplot() +
geom_point(aes(bill_depth_mm, bill_length_mm, color = sex, alpha = 0.1)) +
# Labels
xlab("Bill Depth (mm)") + ylab("Bill Length (mm)") +
labs(title = "Bill Sizes vs Gender") +
labs(subtitle = "Gentoo (Pygoscelis papua)") +
# Annotation
## Drawing a line through gender separation
annotate("segment",
x = 14, xend = 15.4, y = 53.4, yend = 43,
color = "gray",
linetype = 2)  +
## Labeling Line
annotate("text",
x = 14.4, y = 55,
label = "gender separation",
color = "darkgray") +
## Labeling male portion
annotate("text",
x = 16.5 , y = 55,
label = "males",
color = "darkgray",
size = 5) +
## Labeling female portion
annotate("text",
x = 13.8 , y = 43,
label = "females",
color = "darkgray",
size = 5)
## Gentoo
penguins %>%
filter(species == "Gentoo") %>%
ggplot() +
geom_point(aes(bill_depth_mm, bill_length_mm, color = sex, alpha = 0.1)) +
# Labels
xlab("Bill Depth (mm)") + ylab("Bill Length (mm)") +
labs(title = "Bill Sizes vs Gender") +
labs(subtitle = "Gentoo (Pygoscelis papua)") +
# Annotation
## Drawing a line through gender separation
annotate("segment",
x = 14, xend = 15.4, y = 53.4, yend = 43,
color = "gray",
linetype = 2)  +
## Labeling Line
annotate("text",
x = 13.5, y = 55,
label = "gender separation",
color = "darkgray") +
## Labeling male portion
annotate("text",
x = 16.5 , y = 55,
label = "males",
color = "darkgray",
size = 5) +
## Labeling female portion
annotate("text",
x = 13.8 , y = 43,
label = "females",
color = "darkgray",
size = 5)
## Gentoo
penguins %>%
filter(species == "Gentoo") %>%
ggplot() +
geom_point(aes(bill_depth_mm, bill_length_mm, color = sex, alpha = 0.1)) +
# Labels
xlab("Bill Depth (mm)") + ylab("Bill Length (mm)") +
labs(title = "Bill Sizes vs Gender") +
labs(subtitle = "Gentoo (Pygoscelis papua)") +
# Annotation
## Drawing a line through gender separation
annotate("segment",
x = 14, xend = 15.4, y = 53.4, yend = 43,
color = "gray",
linetype = 2)  +
## Labeling Line
annotate("text",
x = 14, y = 55,
label = "gender separation",
color = "darkgray") +
## Labeling male portion
annotate("text",
x = 16.5 , y = 55,
label = "males",
color = "darkgray",
size = 5) +
## Labeling female portion
annotate("text",
x = 13.8 , y = 43,
label = "females",
color = "darkgray",
size = 5)
## Chinstrap (Pygoscelis antarctica)
penguins %>%
filter(species == "Gentoo") %>%
ggplot() +
geom_point(aes(bill_depth_mm, bill_length_mm, color = sex, alpha = 0.1)) +
# Labels
xlab("Bill Depth (mm)") + ylab("Bill Length (mm)") +
labs(title = "Bill Sizes vs Gender") +
labs(subtitle = "Chinstrap (Pygoscelis antarctica)") +
# Annotation
## Drawing a line through gender separation
annotate("segment",
x = 14, xend = 15.4, y = 53.4, yend = 43,
color = "gray",
linetype = 2)  +
## Labeling Line
annotate("text",
x = 14, y = 55,
label = "gender separation",
color = "darkgray") +
## Labeling male portion
annotate("text",
x = 16.5 , y = 55,
label = "males",
color = "darkgray",
size = 5) +
## Labeling female portion
annotate("text",
x = 13.8 , y = 43,
label = "females",
color = "darkgray",
size = 5)
## Chinstrap (Pygoscelis antarctica)
penguins %>%
filter(species == "Chinstrap") %>%
ggplot() +
geom_point(aes(bill_depth_mm, bill_length_mm, color = sex, alpha = 0.1)) +
# Labels
xlab("Bill Depth (mm)") + ylab("Bill Length (mm)") +
labs(title = "Bill Sizes vs Gender") +
labs(subtitle = "Chinstrap (Pygoscelis antarctica)") +
# Annotation
## Drawing a line through gender separation
annotate("segment",
x = 14, xend = 15.4, y = 53.4, yend = 43,
color = "gray",
linetype = 2)  +
## Labeling Line
annotate("text",
x = 14, y = 55,
label = "gender separation",
color = "darkgray") +
## Labeling male portion
annotate("text",
x = 16.5 , y = 55,
label = "males",
color = "darkgray",
size = 5) +
## Labeling female portion
annotate("text",
x = 13.8 , y = 43,
label = "females",
color = "darkgray",
size = 5)
## Chinstrap (Pygoscelis antarctica)
penguins %>%
filter(species == "Chinstrap") %>%
ggplot() +
geom_point(aes(bill_depth_mm, bill_length_mm, color = sex, alpha = 0.1)) +
# Labels
xlab("Bill Depth (mm)") + ylab("Bill Length (mm)") +
labs(title = "Bill Sizes vs Gender") +
labs(subtitle = "Chinstrap (Pygoscelis antarctica)") +
# Annotation
## Drawing a line through gender separation
annotate("segment",
x = 14, xend = 15.4, y = 53.4, yend = 43,
color = "gray",
linetype = 2)
## Chinstrap (Pygoscelis antarctica)
penguins %>%
filter(species == "Chinstrap") %>%
ggplot() +
geom_point(aes(bill_depth_mm, bill_length_mm, color = sex, alpha = 0.1)) +
# Labels
xlab("Bill Depth (mm)") + ylab("Bill Length (mm)") +
labs(title = "Bill Sizes vs Gender") +
labs(subtitle = "Chinstrap (Pygoscelis antarctica)") +
# Annotation
## Drawing a line through gender separation
annotate("segment",
x = 17, xend = 19, y = 53.4, yend = 43,
color = "gray",
linetype = 2)
## Chinstrap (Pygoscelis antarctica)
penguins %>%
filter(species == "Chinstrap") %>%
ggplot() +
geom_point(aes(bill_depth_mm, bill_length_mm, color = sex, alpha = 0.1)) +
# Labels
xlab("Bill Depth (mm)") + ylab("Bill Length (mm)") +
labs(title = "Bill Sizes vs Gender") +
labs(subtitle = "Chinstrap (Pygoscelis antarctica)") +
# Annotation
## Drawing a line through gender separation
annotate("segment",
x = 17, xend = 19, y = 53.4, yend = 43,
color = "gray",
linetype = 2) +
## Labeling Line
annotate("text",
x = 14, y = 55,
label = "gender separation",
color = "darkgray") +
## Labeling male portion
annotate("text",
x = 16.5 , y = 55,
label = "males",
color = "darkgray",
size = 5) +
## Labeling female portion
annotate("text",
x = 13.8 , y = 43,
label = "females",
color = "darkgray",
size = 5)
## Chinstrap (Pygoscelis antarctica)
penguins %>%
filter(species == "Chinstrap") %>%
ggplot() +
geom_point(aes(bill_depth_mm, bill_length_mm, color = sex, alpha = 0.1)) +
# Labels
xlab("Bill Depth (mm)") + ylab("Bill Length (mm)") +
labs(title = "Bill Sizes vs Gender") +
labs(subtitle = "Chinstrap (Pygoscelis antarctica)") +
# Annotation
## Drawing a line through gender separation
annotate("segment",
x = 17, xend = 19, y = 53.4, yend = 43,
color = "gray",
linetype = 2) +
## Labeling Line
annotate("text",
x = 17, y = 55,
label = "gender separation",
color = "darkgray") +
## Labeling male portion
annotate("text",
x = 16.5 , y = 55,
label = "males",
color = "darkgray",
size = 5) +
## Labeling female portion
annotate("text",
x = 13.8 , y = 43,
label = "females",
color = "darkgray",
size = 5)
## Chinstrap (Pygoscelis antarctica)
penguins %>%
filter(species == "Chinstrap") %>%
ggplot() +
geom_point(aes(bill_depth_mm, bill_length_mm, color = sex, alpha = 0.1)) +
# Labels
xlab("Bill Depth (mm)") + ylab("Bill Length (mm)") +
labs(title = "Bill Sizes vs Gender") +
labs(subtitle = "Chinstrap (Pygoscelis antarctica)") +
# Annotation
## Drawing a line through gender separation
annotate("segment",
x = 17, xend = 19, y = 53.4, yend = 43,
color = "gray",
linetype = 2) +
## Labeling Line
annotate("text",
x = 17, y = 55,
label = "gender separation",
color = "darkgray") +
## Labeling male portion
annotate("text",
x = 20, y = 55,
label = "males",
color = "darkgray",
size = 5) +
## Labeling female portion
annotate("text",
x = 13.8 , y = 43,
label = "females",
color = "darkgray",
size = 5)
## Chinstrap (Pygoscelis antarctica)
penguins %>%
filter(species == "Chinstrap") %>%
ggplot() +
geom_point(aes(bill_depth_mm, bill_length_mm, color = sex, alpha = 0.1)) +
# Labels
xlab("Bill Depth (mm)") + ylab("Bill Length (mm)") +
labs(title = "Bill Sizes vs Gender") +
labs(subtitle = "Chinstrap (Pygoscelis antarctica)") +
# Annotation
## Drawing a line through gender separation
annotate("segment",
x = 17, xend = 19, y = 53.4, yend = 43,
color = "gray",
linetype = 2) +
## Labeling Line
annotate("text",
x = 17, y = 55,
label = "gender separation",
color = "darkgray") +
## Labeling male portion
annotate("text",
x = 20, y = 55,
label = "males",
color = "darkgray",
size = 5) +
## Labeling female portion
annotate("text",
x = 17, y = 43,
label = "females",
color = "darkgray",
size = 5)
install.packages("patchwork")
library(pathwork)
library(patchwork)
train <- penguins %>% drop_na()
View(train)
train <- penguins %>% drop_na() %>% select(-c(year, island))
# Modeling gender ---------------------------------------------------------
set.seed(1234)
clean <- penguins %>% drop_na() %>% select(-c(year, island))
split_index <- createDataPartition(clean[,sex], p = .75)
clean <- penguins %>% drop_na() %>% select(-c(year, island))
split_index <- createDataPartition(clean[,sex], p = .75)
split_index <- createDataPartition(clean[,'sex'], p = .75)
View(clean)
split_index <- createDataPartition(clean$sex, p = .75)
train <- clean[split_index,]
clean$sex <- clean$sex %>% factor()
split_index <- createDataPartition(clean$sex, p = .75)
split_index <- createDataPartition(clean[,'sex'], p = .75)
split_index <- createDataPartition(clean[,'sex'], p = .75, list=FALSE, times=1)
clean$species <- clean$species %>% factor()
library(caret)
x_names = c("species","bill_length_mm", "bill_depth_mm", "flipper_length_mm", "body_mass_g")
x_names <- c("species","bill_length_mm", "bill_depth_mm", "flipper_length_mm", "body_mass_g")
y_names <- c("sex")
clean[,y_names]
clean[,x_names]
rm(train)
train(clean[,x_names], clean[,y_names],
method = 'gbm',
metric = 'roc')
clean[,y_names] %>% summary()
clean[,y_names] %>% type()
clean[,y_names]
train(clean[,x_names], clean[,y_names],
method = 'gbm')
clean <- penguins %>% drop_na() %>% select(-c(year, island))
clean$sex <- clean$sex %>% factor()
clean$species <- clean$species %>% factor()
x_names <- c("species","bill_length_mm", "bill_depth_mm", "flipper_length_mm", "body_mass_g")
y_names <- c("sex")
## Logistic
fit.glm <- train(sex~., data = clean, method='glm')
install.packages("e1071")
## Preparing testing
set.seed(1234)
control <- trainControl(method='cv', number=10)
metric <- "Accuracy"
## Logistic
fit.glm <- train(sex~., data = clean, method='glm', metric=metric, trControl = control)
fit.glm
## Logistic
fit.glm <- train(sex~., data = clean, method='glmboost', metric=metric, trControl = control)
## Logistic
fit.glm <- train(sex~., data = clean, method='glmboost', metric=metric, trControl = control)
fit.glm
## Logistic
fit.glm <- train(sex~., data = clean, method='bstTree', metric=metric, trControl = control)
## Logistic
fit.glm <- train(sex~., data = clean, method='bstTree', metric=metric, trControl = control)
fit.glm
## Logistic
fit.glm <- train(sex~., data = clean, method='glmnet', metric=metric, trControl = control)
## Logistic
fit.glm <- train(sex~., data = clean, method='glmnet', metric=metric, trControl = control)
fit.glm
## Logistic
fit.glm <- train(sex~., data = clean, method='lda', metric=metric, trControl = control)
fit.glm
## Fitting
penguins %>% select(-c(year, island)) %>%
filter(is.na(sex))
## Fitting
penguins %>% select(-c(year, island)) %>%
filter(is.na(sex) && !is.na(x_names))
## Fitting
penguins %>% select(-c(year, island)) %>%
filter(is.na(sex) && !is.na(body_mass_g))
## Fitting
penguins %>% select(-c(year, island)) %>%
filter(is.na(sex) && is.na(body_mass_g))
## Fitting
penguins %>% select(-c(year, island)) %>%
filter(is.na(sex) )
## Fitting
penguins %>% select(-c(year, island)) %>%
filter(is.na(sex) ) -> yee
## Fitting
penguins %>% select(-c(year, island, sex)) %>%
filter(is.na(sex) ) -> yee
## Fitting
penguins %>% filter(is.na(sex))
select(-c(year, island, sex)) -> yee
## Fitting
penguins %>% filter(is.na(sex))
predict(fit.glm, yee)
## penguins manip
penguins %>% mutate(inferred = is.na(sex))
## penguins manip
penguins %>% mutate(inferred = is.na(sex)) -> penguins
penguins[,inferred==TRUE]
penguins[,"inferred"==TRUE]
penguins[,"inferred"]
penguins[,[penguins$inferred == TRUE]]
penguins[,penguins$inferred == TRUE]
penguins[inferred == TRUE]
penguins
penguins[penguins$inferred == TRUE]
penguins[penguins$inferred]
penguins[,penguins$inferred]
penguins[:,penguins$inferred]
penguins[penguins$inferred]
penguins$inferred
penguins[inferred]
penguins[penguins$inferred]
penguins[penguins$inferred,]
penguins %>% filter(!is.na(bill_length_mm)) -> penguins
